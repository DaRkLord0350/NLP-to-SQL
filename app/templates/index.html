<!doctype html>
<html lang="en" class="h-full">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NLP ‚Üí SQL</title>
  <script src="https://unpkg.com/htmx.org@1.9.12"></script>

  <!-- Tailwind + force dark mode by class -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script> tailwind.config = { darkMode: 'class' }; </script>

  <!-- Theme bootstrap: prefer saved, else system; listen to OS changes only if no manual choice -->
  <script>
    (function () {
      const saved = localStorage.getItem("theme"); // "dark" | "light" | null
      const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
      const root = document.documentElement;
      const useDark = saved ? saved === "dark" : prefersDark;
      root.classList.toggle("dark", useDark);

      // sync with OS if no manual choice
      const mq = window.matchMedia("(prefers-color-scheme: dark)");
      mq.addEventListener("change", e => {
        if (localStorage.getItem("theme")) return; // user override
        root.classList.toggle("dark", e.matches);
        updateThemeToggleLabel();
      });
    })();

    function updateThemeToggleLabel() {
      const btn = document.getElementById("themeToggle");
      if (!btn) return;
      const isDark = document.documentElement.classList.contains("dark");
      btn.querySelector(".theme-icon").textContent = isDark ? "‚òÄÔ∏è" : "üåô";
      btn.querySelector(".theme-text").textContent = isDark ? "Light" : "Dark";
    }

    function toggleTheme() {
      const root = document.documentElement;
      const isDark = root.classList.toggle("dark");
      localStorage.setItem("theme", isDark ? "dark" : "light");
      updateThemeToggleLabel();
    }

    document.addEventListener("DOMContentLoaded", updateThemeToggleLabel);
  </script>
</head>


  <body class="h-full min-h-screen bg-gray-50 text-gray-900 dark:bg-neutral-900 dark:text-neutral-100">
    <div class="max-w-4xl mx-auto p-6">
      <!-- Header -->
      <header class="mb-6 flex items-start justify-between gap-4">
        <div>
          <h1 class="text-3xl font-bold">üóÑÔ∏è Natural Language ‚Üí SQL</h1>
          <p class="text-gray-600 dark:text-neutral-400">
            Ask about your Walmart sales data. Get SQL, results, and an explanation.
          </p>
        </div>

        <!-- Dark mode toggle -->
        <button
          id="themeToggle"
          type="button"
          onclick="toggleTheme()"
          class="inline-flex items-center gap-2 rounded-xl border border-gray-200 dark:border-neutral-700 px-3 py-2 text-sm hover:bg-gray-100 dark:hover:bg-neutral-800 focus:outline-none focus:ring-2 focus:ring-blue-500"
          aria-label="Toggle theme"
        >
          <span class="theme-icon">üåô</span>
          <span class="theme-text">Dark</span>
        </button>
      </header>

      <!-- Form -->
      <form
        class="card p-4 space-y-3"
        hx-post="/ui/predict"
        hx-target="#panel"
        hx-swap="innerHTML"
        hx-indicator="#loader"
      >
        <textarea
          name="question"
          rows="3"
          class="w-full border border-gray-200 dark:border-neutral-700 bg-white dark:bg-neutral-900 rounded-xl p-3 outline-none focus:ring-2 focus:ring-blue-500"
          placeholder="e.g., What are the top 3 product lines by revenue?"
        ></textarea>
        <div class="flex items-center gap-3">
          <button
            class="px-4 py-2 rounded-xl bg-black text-white dark:bg-white dark:text-black hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-blue-500"
            type="submit"
          >
            üîç Run
          </button>
          <span class="text-xs text-gray-500 dark:text-neutral-400">Tip: try ‚ÄúShow monthly sales trends‚Äù</span>
        </div>

        <!-- Loader (HTMX indicator) -->
        <div id="loader" class="htmx-indicator mt-4">
          <div class="card p-4">
            <div class="flex items-center gap-3">
              <div class="h-5 w-5 rounded-full border-2 border-gray-300 dark:border-neutral-600 border-t-transparent animate-spin"></div>
              <div class="text-sm text-gray-700 dark:text-neutral-300">Running your query‚Ä¶</div>
            </div>
          </div>
        </div>
      </form>

      <!-- Results mount -->
      <div id="panel" class="mt-6" style= "color: black;"></div>

      <!-- Quick examples -->
      <section class="mt-10">
        <h2 class="text-xl font-semibold mb-2">Quick Examples</h2>
        <div class="grid sm:grid-cols-2 gap-2">
          <button class="px-3 py-2 card text-left hover:bg-gray-50 dark:hover:bg-neutral-700"
            hx-post="/ui/predict"
            hx-vals='{"question":"Find the total revenue generated by each branch"}'
            hx-target="#panel" hx-swap="innerHTML" hx-indicator="#loader">
            Branch-wise total revenue
          </button>

          <button class="px-3 py-2 card text-left hover:bg-gray-50 dark:hover:bg-neutral-700"
            hx-post="/ui/predict"
            hx-vals='{"question":"Which payment method generates the highest average gross income?"}'
            hx-target="#panel" hx-swap="innerHTML" hx-indicator="#loader">
            Best payment method
          </button>

          <button class="px-3 py-2 card text-left hover:bg-gray-50 dark:hover:bg-neutral-700"
            hx-post="/ui/predict"
            hx-vals='{"question":"Show monthly sales trends"}'
            hx-target="#panel" hx-swap="innerHTML" hx-indicator="#loader">
            Monthly trends
          </button>

          <button class="px-3 py-2 card text-left hover:bg-gray-50 dark:hover:bg-neutral-700"
            hx-post="/ui/predict"
            hx-vals='{"question":"Compare average spending between Member and Normal customers"}'
            hx-target="#panel" hx-swap="innerHTML" hx-indicator="#loader">
            Member vs Normal
          </button>
        </div>
      </section>
    </div>
  </body>
</html>
